#include factorial.dc
#include pi.dc

# Function:
#   (trig)S: Sine
[Z;Sx]sS

# (trig)S: Sine
# @return sin(x) | TOS
[
 0Sk
 [KdSK3+klPx2*0k%LKk1/]Sm # mod 2pi
 [_1lk^ lxlk2*1+^* lk2*1+l!x / lk1+sk]ST
 KSK
 KSn
 K2*k
 lmx Sx
 0[lTxd0!=L+]dSLx # calculate terms until next term is 0 (i.e., less than precision)
 lKk 1/
 0LmZ*LLZ*LTZ*Lk*Ln*Lx*LK*K+k
] [trig]Z:S
